{"version":3,"sources":["webpack:///webpack/bootstrap ffca06bcbe22a8b599ad","webpack:///./src/server/server.js","webpack:///external \"source-map-support/register\"","webpack:///external \"express\"","webpack:///external \"http\"","webpack:///external \"socket.io\"","webpack:///external \"chalk\"","webpack:///external \"rxjs\"","webpack:///./src/shared/observable-socket.js","webpack:///external \"webpack-dev-middleware\"","webpack:///external \"webpack-hot-middleware\"","webpack:///external \"webpack\"","webpack:///./webpack.client.js","webpack:///external \"path\"","webpack:///external \"extract-text-webpack-plugin\""],"names":["isDevelopment","process","env","NODE_ENV","app","server","Server","io","USE_WEBPACK","webpackMiddleware","require","webpackHotMiddleware","webpack","clientConfig","compiler","use","publicPath","stats","colors","chunks","asstes","timings","modules","hash","version","console","log","bgRed","set","static","useExternalStyles","get","req","res","render","users","UsersModule","chat","ChatModule","playlist","PlaylistModule","playlistRepository","videoServices","on","socket","request","connection","remoteAddress","client","mod","registerClient","clientRegistered","port","PORT","startServer","listen","clientMessage","message","error","Error","ObservableSocket","_state","isConnected","isReconnecting","_socket","_actionCallbacks","_requests","_nextRequestId","status$","merge","on$","map","attempt","publishReplay","refCount","subscribe","state","event","fromEvent","callback","off","arg","emit","action","id","_registerCallbacks","subject","hasOwnProperty","_popRequest","next","complete","requestId","value","hasValue","item","_emitError","stack","actions","onAction","path","ExtractTextPlugin","vendorModules","dirname","resolve","createConfig","isDebug","devTool","plugins","optimize","CommonsChunkPlugin","cssLoader","test","loader","sassLoader","appEntry","push","UglifyJsPlugin","extract","HotModuleReplacementPlugin","splice","devtool","entry","application","vendor","output","join","filename","alias","shared","module","loaders","exclude","exports","create"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap ffca06bcbe22a8b599ad\n **/","// server.js = the entry into our application!!!!!!!!!!!!!!!!!\nimport \"source-map-support/register\";\n\nimport express from \"express\";\nimport http from \"http\";\nimport socketIo from \"socket.io\";\nimport chalk from \"chalk\";\nimport {Observable} from \"rxjs\";\n\nimport {ObservableSocket} from \"shared/observable-socket\";\n\nconst isDevelopment = process.env.NODE_ENV !== \"production\";\n\n//----------------------------------------------------------------------------\n// SETUP:\nconst app = express();\nconst server = new http.Server(app);\nconst io = socketIo(server);\n\n//----------------------------------------------------------------------------\n// Client webpack\nif (process.env.USE_WEBPACK === \"true\") {\n    var webpackMiddleware = require(\"webpack-dev-middleware\"),\n        webpackHotMiddleware = require(\"webpack-hot-middleware\"),\n        webpack = require(\"webpack\"),\n        clientConfig = require(\"../../webpack.client\");\n\n    const compiler = webpack(clientConfig);\n    app.use(webpackMiddleware(compiler, {\n        publicPath: \"/build/\",\n        stats: {\n            colors: true,\n            chunks: false,\n            asstes: false,\n            timings: false,\n            modules: false,\n            hash: false,\n            version: false\n        }\n    }));\n    app.use(webpackHotMiddleware(compiler));\n\n    console.log(chalk.bgRed(\"Using WebPack Dev Middleware! FOR DEV ONLY!!!\"));\n}\n\n\n//----------------------------------------------------------------------------\n// Configure Express\napp.set(\"view engine\", \"jade\");\napp.use(express.static(\"publc\"));\n\nconst useExternalStyles = isDevelopment;\n// our only route:\napp.get(\"/\", (req, res) => {\n    res.render(\"index\", {\n        useExternalStyles\n    });\n});\n\n//----------------------------------------------------------------------------\n// Modules\nconst users = new UsersModule(io);\nconst chat = new ChatModule(io, users);\nconst playlist = new PlaylistModule(io, users, playlistRepository, videoServices);\nconst modules = [users, chat, playlist];\n\n\n//----------------------------------------------------------------------------\n// socket\nio.on(\"connection\", socket => {\n    console.log(`===> Got connection from: ${socket.request.connection.remoteAddress}`);\n\n    const client = new ObservableSocket(socket);\n\n\tfor (let mod of modules) {\n\t\tmod.registerClient(client);\n\t}\n\tfor (let mod of modules) {\n\t\tmod.clientRegistered(client);\n    }\n    // // test-o import:-----------------------------------------------------------\n    // let index = 0;\n    // setInterval(() => {\n    //     socket.emit(\"test\", `On Index ${index++} `);\n    // }, 1000);\n});\n\n\n\n//----------------------------------------------------------------------------\n// startup\nconst port = process.env.PORT || 3000;\nfunction startServer () {\n    server.listen(port, () => {\n        console.log(`===> Started http server on port: ${port}`);\n    });\n};\n\nstartServer();\n//----------------------------------------------------------------------------\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/server.js\n **/","module.exports = require(\"source-map-support/register\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"source-map-support/register\"\n ** module id = 1\n ** module chunks = 0\n **/","module.exports = require(\"express\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = require(\"http\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"http\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = require(\"socket.io\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"socket.io\"\n ** module id = 4\n ** module chunks = 0\n **/","module.exports = require(\"chalk\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"chalk\"\n ** module id = 5\n ** module chunks = 0\n **/","module.exports = require(\"rxjs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"rxjs\"\n ** module id = 6\n ** module chunks = 0\n **/","import {Observable, ReplaySubject} from \"rxjs\";\n\nexport function clientMessage(message) {\n\tconst error = new Error(message);\n\terror.clientMessage = message;\n\treturn error;\n}\n\nexport class ObservableSocket {\n    get isConnected() { return this._state.isConnected; }\n    get isReconnecting() { return this._state.isReconnecting; }\n    get isTotallyDead() { return !this.isConnected && !this.isReconnecting; }\n\n    constructor(socket) {\n        this._socket = socket;\n        this._state = {};\n        this._actionCallbacks = {};\n        this._requests = {};\n        this._nextRequestId = 0;\n\n        this.status$ = Observable.merge(\n            this.on$(\"connect\").map(() => ({ isConnected: true })),\n            this.on$(\"disconnect\").map(() => ({ isConnected: false })),\n            this.on$(\"reconnecting\").map(attempt => ({ isConnected: false, isReconnecting: true, attempt })),\n            this.on$(\"reconnect_failed\").map(() => ({ isConnected: false, isReconnecting: false })))\n            .publishReplay(1)\n            .refCount();\n\n        this.status$.subscribe(state => this._state = state);this._socket = socket;\n    }\n\n    //-----------------------------\n    // Basic wrappers:\n    on$(event) {\n        return Observable.fromEvent(this._socket, event);\n    }\n\n    on(event, callback) {\n        this._socket.on(event, callback);\n    }\n\n    off(event, callback) {\n        this._socket.off(event, callback);\n    }\n\n    emit(event, arg) {\n        this._socket.emit(event, arg);\n    }\n\n    //-------------------------------\n    // (Emit) Client side:\n    emitAction$(action, arg) {\n        const id = this._nextRequestId++;\n\t\tthis._registerCallbacks(action);\n        //                                       like a promise:\n\t\tconst subject = this._requests[id] = new ReplaySubject(1);\n\t\tthis._socket.emit(action, arg, id);\n\t\treturn subject;\n\t}\n\n\t_registerCallbacks(action) {\n\t\tif (this._actionCallbacks.hasOwnProperty(action))\n\t\t\treturn;\n\n\t\tthis._socket.on(action, (arg, id) => {\n\t\t\tconst request = this._popRequest(id);\n\t\t\tif (!request)\n\t\t\t\treturn;\n\n\t\t\trequest.next(arg); // method on ObservableSocket\n\t\t\trequest.complete(); // method on ObservableSocket\n\t\t});\n\n\t\tthis._socket.on(`${action}:fail`, (arg, id) => {\n\t\t\tconst request = this._popRequest(id);\n\t\t\tif (!request)\n\t\t\t\treturn;\n\n\t\t\trequest.error(arg);\n\t\t});\n\n\t\tthis._actionCallbacks[action] = true;\n\t}\n\n\t_popRequest(id) {\n\t\tif (!this._requests.hasOwnProperty(id)) {\n\t\t\tconsole.error(`Event with id ${id} was returned twice,\n                            or the server did not send back an ID!`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst request = this._requests[id];\n\t\tdelete this._requests[id];\n\t\treturn request;\n    } //-----------------------------------------------------------------------\n\n\n    //-------------------------------\n    // (On) Sever side:\n    onAction(action, callback) {\n        this._socket.on(action, (arg, requestId) => {\n\t\t\ttry {\n\t\t\t\tconst value = callback(arg);\n\t\t\t\tif (!value) { // no value\n\t\t\t\t\tthis._socket.emit(action, null, requestId);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (typeof(value.subscribe) !== \"function\") {\n\t\t\t\t\tthis._socket.emit(action, value, requestId);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet hasValue = false;\n\t\t\t\tvalue.subscribe({\n\t\t\t\t\tnext: (item) => {\n\t\t\t\t\t\tif (hasValue)\n\t\t\t\t\t\t\tthrow new Error(`Action ${action} produced more than one value.`);\n\n\t\t\t\t\t\tthis._socket.emit(action, item, requestId);\n\t\t\t\t\t\thasValue = true;\n\t\t\t\t\t},\n\n\t\t\t\t\terror: (error) => {\n\t\t\t\t\t\tthis._emitError(action, requestId, error);\n\t\t\t\t\t\tconsole.error(error.stack || error);\n\t\t\t\t\t},\n\n\t\t\t\t\tcomplete: () => {\n\t\t\t\t\t\tif (!hasValue)\n\t\t\t\t\t\t\tthis._socket.emit(action, null, requestId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tcatch (error) {\n\t\t\t\tif (typeof(requestId) !== \"undefined\")\n\t\t\t\t\tthis._emitError(action, requestId, error);\n\n\t\t\t\tconsole.error(error.stack || error);\n\t\t\t}\n\t\t});\n    }\n\n\tonActions(actions) {\n\t\tfor (let action in actions) {\n\t\t\tif (!actions.hasOwnProperty(action))\n\t\t\t\tcontinue;\n\n\t\t\tthis.onAction(action, actions[action]);\n\t\t}\n\t}\n\n\t_emitError(action, id, error) {\n\t\tconst message = (error && error.clientMessage) || \"Fatal Error\";\n\t\tthis._socket.emit(`${action}:fail`, {message}, id);\n\t}\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//-----------------------------------------------------------------------------\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/shared/observable-socket.js\n **/","module.exports = require(\"webpack-dev-middleware\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"webpack-dev-middleware\"\n ** module id = 8\n ** module chunks = 0\n **/","module.exports = require(\"webpack-hot-middleware\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"webpack-hot-middleware\"\n ** module id = 9\n ** module chunks = 0\n **/","module.exports = require(\"webpack\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"webpack\"\n ** module id = 10\n ** module chunks = 0\n **/","var path = require(\"path\");\nvar webpack = require(\"webpack\");\nvar ExtractTextPlugin = require(\"extract-text-webpack-plugin\");\n\nconst vendorModules = [\"jquery\", \"lodash\", \"socket.io-client\", \"rxjs\"];\n\nconst dirname = path.resolve(\"./\"); // work-around for webpack from server\n\n\n\nfunction createConfig (isDebug) {\n    const devTool = isDebug ? \"eval-source-map\" : \"source-map\";\n    const plugins = [new webpack.optimize.CommonsChunkPlugin(\"vendor\", \"vendor.js\")];\n\n    const cssLoader = { test: /\\.css$/, loader: \"style!css\" };\n    const sassLoader = { test: /\\.scss$/, loader: \"style!css!sass\" };\n    const appEntry = ['./src/client/application.js']; // might load up diff files\n\n    // IS production:\n    if (!isDebug) {\n        plugins.push(new webpack.optimize.UglifyJsPlugin());\n        plugins.push(new ExtractTextPlugin(\"[name].css\"));\n\n        cssLoader.loader = ExtractTextPlugin.extract(\"style\", \"css\");\n        sassLoader.loader = ExtractTextPlugin.extract(\"style\", \"css!sass\");\n    } else {\n        // Dev mode:\n        plugins.push(new webpack.HotModuleReplacementPlugin());\n        appEntry.splice(0, 0, \"webpack-hot-middleware/client\");\n    }\n\n    // return WEBPACK Config:---------------------------------------\n    return {\n        devtool: devTool,\n        entry: {\n            application: appEntry,\n            vendor: vendorModules\n        },\n        output: {\n            path: path.join(dirname, \"public\", \"build\"),\n            filename: \"[name].js\",\n            publicPath: \"/build/\"\n        },\n        resolve: {\n            alias: {\n                shared: path.join(dirname, \"src\", \"shared\")\n            }\n        },\n        module: {\n\t\t\tloaders: [\n\t\t\t\t{ test: /\\.js$/, loader: \"babel\", exclude: /node_modules/ },\n\t\t\t\t{ test: /\\.js$/, loader: \"eslint\", exclude: /node_modules/ },\n\t\t\t\t{ test: /\\.(png|jpg|jpeg|gif|woff|ttf|eot|svg|woff2)/, loader: \"url-loader?limit=1024\" },\n\t\t\t\tcssLoader,\n\t\t\t\tsassLoader\n\t\t\t]\n\t\t},\n\t\tplugins: plugins\n    };\n}; //--------------------------------------------------------------------------\n\n\n\nmodule.exports = createConfig(true);\nmodule.exports.create = createConfig;\n\n\n\n/** WEBPACK FOOTER **\n ** ./webpack.client.js\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 12\n ** module chunks = 0\n **/","module.exports = require(\"extract-text-webpack-plugin\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"extract-text-webpack-plugin\"\n ** module id = 13\n ** module chunks = 0\n **/"],"sourceRoot":""}